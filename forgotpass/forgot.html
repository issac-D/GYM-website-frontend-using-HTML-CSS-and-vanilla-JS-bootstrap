<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DBU Gym - Recover Password</title>
    
    <!-- Bootstrap 5 CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="forgot.css">

</head>
<body>

    <!-- Header & Toggle -->
    <header class="container simple-header position-relative">
        <h3 class="fw-bold m-0"><span class="highlight"><i class="fas fa-dumbbell me-2"></i>DBU</span> Gym</h3>
        <button id="theme-toggle" aria-label="Toggle Dark Mode">
            <i class="fas fa-moon"></i>
        </button>
    </header>

    <!-- Main Content -->
    <div class="auth-wrapper">
        <div class="auth-card">
            
            <!-- Step 1: Enter Email -->
            <div id="step1" class="step-container">
                <div class="text-center mb-4">
                    <i class="fas fa-lock fa-3x mb-3"></i>
                    <h2 class="h4 fw-bold">Forgot Password?</h2>
                    <p class="small" style="color: var(--text-muted);">Enter your email address and we'll send you a verification code.</p>
                </div>
                
                <form id="emailForm">
                    <div class="mb-3">
                        <label for="email" class="form-label">Email Address</label>
                        <input type="email" class="form-control" id="email" placeholder="name@example.com" required>
                        <div class="invalid-feedback" id="emailFeedback">Please enter a valid email.</div>
                    </div>
                    <button type="submit" class="btn btn-primary w-100 mb-3">
                        Send Reset Code
                    </button>
                    <div class="text-center">
                        <a href="../login/login.html" class="text-decoration-none small" style="color: var(--text-muted);"><i class="fas fa-arrow-left me-1"></i> Back to Login</a>
                    </div>
                </form>
            </div>

            <!-- Step 2: Verify Code -->
            <div id="step2" class="step-container d-none">
                <div class="text-center mb-4">
                    <i class="fas fa-envelope-open-text fa-3x highlight mb-3"></i>
                    <h2 class="h4 fw-bold">Verify Your Email</h2>
                    <p class="text-muted small">We sent a 6-digit code to <strong id="displayEmail"></strong>.<br>Check your console (F12) for the code.</p>
                </div>

                <div id="codeAlert" class="alert alert-danger d-none py-2 small" role="alert">
                    Invalid code. Please try again.
                </div>

                <form id="codeForm">
                    <div class="mb-3">
                        <label for="verificationCode" class="form-label">Verification Code</label>
                        <input type="text" class="form-control text-center fw-bold fs-4" id="verificationCode" placeholder="000000" maxlength="6" pattern="\d{6}" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100 mb-3">
                        Verify Code
                    </button>
                    <div class="text-center">
                        <p class="small text-muted mb-0">Didn't receive code? <a href="#" id="resendLink" class="text-decoration-none highlight">Resend</a></p>
                        <a href="#" id="backToStep1" class="text-decoration-none text-muted small mt-2 d-inline-block">Change Email</a>
                    </div>
                </form>
            </div>

            <!-- Step 3: Reset Password -->
            <div id="step3" class="step-container d-none">
                <div class="text-center mb-4">
                    <i class="fas fa-key fa-3x text-success mb-3"></i>
                    <h2 class="h4 fw-bold">Set New Password</h2>
                    <p class="text-muted small">Please choose a strong password for your account.</p>
                </div>

                <div id="passwordAlert" class="alert alert-danger d-none py-2 small" role="alert"></div>

                <form id="passwordForm">
                    <div class="mb-3">
                        <label for="newPassword" class="form-label">New Password</label>
                        <div class="input-group">
                            <input type="password" class="form-control" id="newPassword" placeholder="••••••••" required minlength="6">
                            <button class="btn btn-outline-secondary bg-transparent" type="button" onclick="togglePassword('newPassword')"><i class="fas fa-eye"></i></button>
                        </div>
                        <div class="form-text small">Min. 6 characters.</div>
                    </div>
                    <div class="mb-4">
                        <label for="confirmPassword" class="form-label">Confirm Password</label>
                        <div class="input-group">
                            <input type="password" class="form-control" id="confirmPassword" placeholder="••••••••" required>
                            <button class="btn btn-outline-secondary bg-transparent" type="button" onclick="togglePassword('confirmPassword')"><i class="fas fa-eye"></i></button>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">
                        Reset Password
                    </button>
                </form>
            </div>

            <!-- Success State -->
            <div id="successState" class="step-container d-none text-center">
                <i class="fas fa-check-circle fa-4x text-success mb-3"></i>
                <h2 class="h4 fw-bold">Password Reset!</h2>
                <p class="text-muted">Your password has been successfully updated. Redirecting you to login...</p>
                <div class="spinner-border text-primary mt-3" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>

        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script src="./forgot.js"> </script>
</body>
</html>